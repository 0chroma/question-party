/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is a compiled version of Dojo, built for deployment and not for
	development. To get an editable version, please visit:

		http://dojotoolkit.org

	for documentation and information on getting the source.
*/

if(!dojo._hasResource["dojo.date.stamp"]){dojo._hasResource["dojo.date.stamp"]=true;dojo.provide("dojo.date.stamp");dojo.date.stamp.fromISOString=function(_1,_2){if(!dojo.date.stamp._isoRegExp){dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _3=dojo.date.stamp._isoRegExp.exec(_1),_4=null;if(_3){_3.shift();if(_3[1]){_3[1]--;}if(_3[6]){_3[6]*=1000;}if(_2){_2=new Date(_2);dojo.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(_5){return _2["get"+_5]();}).forEach(function(_6,_7){if(_3[_7]===undefined){_3[_7]=_6;}});}_4=new Date(_3[0]||1970,_3[1]||0,_3[2]||1,_3[3]||0,_3[4]||0,_3[5]||0,_3[6]||0);if(_3[0]<100){_4.setFullYear(_3[0]||1970);}var _8=0,_9=_3[7]&&_3[7].charAt(0);if(_9!="Z"){_8=((_3[8]||0)*60)+(Number(_3[9])||0);if(_9!="-"){_8*=-1;}}if(_9){_8-=_4.getTimezoneOffset();}if(_8){_4.setTime(_4.getTime()+_8*60000);}}return _4;};dojo.date.stamp.toISOString=function(_a,_b){var _c=function(n){return (n<10)?"0"+n:n;};_b=_b||{};var _d=[],_e=_b.zulu?"getUTC":"get",_f="";if(_b.selector!="time"){var _10=_a[_e+"FullYear"]();_f=["0000".substr((_10+"").length)+_10,_c(_a[_e+"Month"]()+1),_c(_a[_e+"Date"]())].join("-");}_d.push(_f);if(_b.selector!="date"){var _11=[_c(_a[_e+"Hours"]()),_c(_a[_e+"Minutes"]()),_c(_a[_e+"Seconds"]())].join(":");var _12=_a[_e+"Milliseconds"]();if(_b.milliseconds){_11+="."+(_12<100?"0":"")+_c(_12);}if(_b.zulu){_11+="Z";}else{if(_b.selector!="time"){var _13=_a.getTimezoneOffset();var _14=Math.abs(_13);_11+=(_13>0?"-":"+")+_c(Math.floor(_14/60))+":"+_c(_14%60);}}_d.push(_11);}return _d.join("T");};}if(!dojo._hasResource["dojox.json.ref"]){dojo._hasResource["dojox.json.ref"]=true;dojo.provide("dojox.json.ref");dojox.json.ref={resolveJson:function(_15,_16){_16=_16||{};var _17=_16.idAttribute||"id";var _18=this.refAttribute;var _19=_16.idAsRef;var _1a=_16.idPrefix||"";var _1b=_16.assignAbsoluteIds;var _1c=_16.index||{};var _1d=_16.timeStamps;var ref,_1e=[];var _1f=/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/;var _20=this._addProp;var F=function(){};function _21(it,_22,_23,_24,_25,_26){var i,_27,val,id=_17 in it?it[_17]:_23;if(_17 in it||((id!==undefined)&&_24)){id=(_1a+id).replace(_1f,"$2$3");}var _28=_26||it;if(id!==undefined){if(_1b){it.__id=id;}if(_16.schemas&&(!(it instanceof Array))&&(val=id.match(/^(.+\/)[^\.\[]*$/))){_25=_16.schemas[val[1]];}if(_1c[id]&&((it instanceof Array)==(_1c[id] instanceof Array))){_28=_1c[id];delete _28.$ref;delete _28._loadObject;_27=true;}else{var _29=_25&&_25.prototype;if(_29){F.prototype=_29;_28=new F();}}_1c[id]=_28;if(_1d){_1d[id]=_16.time;}}while(_25){var _2a=_25.properties;if(_2a){for(i in it){var _2b=_2a[i];if(_2b&&_2b.format=="date-time"&&typeof it[i]=="string"){it[i]=dojo.date.stamp.fromISOString(it[i]);}}}_25=_25["extends"];}var _2c=it.length;for(i in it){if(i==_2c){break;}if(it.hasOwnProperty(i)){val=it[i];if((typeof val=="object")&&val&&!(val instanceof Date)&&i!="__parent"){ref=val[_18]||(_19&&val[_17]);if(!ref||!val.__parent){val.__parent=it;}if(ref){delete it[i];var _2d=ref.toString().replace(/(#)([^\.\[])/,"$1.$2").match(/(^([^\[]*\/)?[^#\.\[]*)#?([\.\[].*)?/);if((ref=(_2d[1]=="$"||_2d[1]=="this"||_2d[1]=="")?_15:_1c[(_1a+_2d[1]).replace(_1f,"$2$3")])){if(_2d[3]){_2d[3].replace(/(\[([^\]]+)\])|(\.?([^\.\[]+))/g,function(t,a,b,c,d){ref=ref&&ref[b?b.replace(/[\"\'\\]/,""):d];});}}if(ref){val=ref;}else{if(!_22){var _2e;if(!_2e){_1e.push(_28);}_2e=true;val=_21(val,false,val[_18],true,_2b);val._loadObject=_16.loader;}}}else{if(!_22){val=_21(val,_1e==it,id===undefined?undefined:_20(id,i),false,_2b,_28!=it&&typeof _28[i]=="object"&&_28[i]);}}}it[i]=val;if(_28!=it&&!_28.__isDirty){var old=_28[i];_28[i]=val;if(_27&&val!==old&&!_28._loadObject&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")&&i!="$ref"&&!(val instanceof Date&&old instanceof Date&&val.getTime()==old.getTime())&&!(typeof val=="function"&&typeof old=="function"&&val.toString()==old.toString())&&_1c.onUpdate){_1c.onUpdate(_28,i,old,val);}}}}if(_27&&(_17 in it)){for(i in _28){if(!_28.__isDirty&&_28.hasOwnProperty(i)&&!it.hasOwnProperty(i)&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")&&!(_28 instanceof Array&&isNaN(i))){if(_1c.onUpdate&&i!="_loadObject"&&i!="_idAttr"){_1c.onUpdate(_28,i,_28[i],undefined);}delete _28[i];while(_28 instanceof Array&&_28.length&&_28[_28.length-1]===undefined){_28.length--;}}}}else{if(_1c.onLoad){_1c.onLoad(_28);}}return _28;};if(_15&&typeof _15=="object"){_15=_21(_15,false,_16.defaultId,true);_21(_1e,false);}return _15;},fromJson:function(str,_2f){function ref(_30){var _31={};_31[this.refAttribute]=_30;return _31;};try{var _32=eval("("+str+")");}catch(e){throw new SyntaxError("Invalid JSON string: "+e.message+" parsing: "+str);}if(_32){return this.resolveJson(_32,_2f);}return _32;},toJson:function(it,_33,_34,_35){var _36=this._useRefs;var _37=this._addProp;var _38=this.refAttribute;_34=_34||"";var _39={};var _3a={};function _3b(it,_3c,_3d){if(typeof it=="object"&&it){var _3e;if(it instanceof Date){return "\""+dojo.date.stamp.toISOString(it,{zulu:true})+"\"";}var id=it.__id;if(id){if(_3c!="#"&&((_36&&!id.match(/#/))||_39[id])){var ref=id;if(id.charAt(0)!="#"){if(it.__clientId==id){ref="cid:"+id;}else{if(id.substring(0,_34.length)==_34){ref=id.substring(_34.length);}else{ref=id;}}}var _3f={};_3f[_38]=ref;return _3b(_3f,"#");}_3c=id;}else{it.__id=_3c;_3a[_3c]=it;}_39[_3c]=it;_3d=_3d||"";var _40=_33?_3d+dojo.toJsonIndentStr:"";var _41=_33?"\n":"";var sep=_33?" ":"";if(it instanceof Array){var res=dojo.map(it,function(obj,i){var val=_3b(obj,_37(_3c,i),_40);if(typeof val!="string"){val="undefined";}return _41+_40+val;});return "["+res.join(","+sep)+_41+_3d+"]";}var _42=[];for(var i in it){if(it.hasOwnProperty(i)){var _43;if(typeof i=="number"){_43="\""+i+"\"";}else{if(typeof i=="string"&&(i.charAt(0)!="_"||i.charAt(1)!="_")){_43=dojo._escapeString(i);}else{continue;}}var val=_3b(it[i],_37(_3c,i),_40);if(typeof val!="string"){continue;}_42.push(_41+_40+_43+":"+sep+val);}}return "{"+_42.join(","+sep)+_41+_3d+"}";}else{if(typeof it=="function"&&dojox.json.ref.serializeFunctions){return it.toString();}}return dojo.toJson(it);};var _44=_3b(it,"#","");if(!_35){for(var i in _3a){delete _3a[i].__id;}}return _44;},_addProp:function(id,_45){return id+(id.match(/#/)?id.length==1?"":".":"#")+_45;},refAttribute:"$ref",_useRefs:false,serializeFunctions:false};}if(!dojo._hasResource["dojox.rpc.Rest"]){dojo._hasResource["dojox.rpc.Rest"]=true;dojo.provide("dojox.rpc.Rest");(function(){if(dojox.rpc&&dojox.rpc.transportRegistry){dojox.rpc.transportRegistry.register("REST",function(str){return str=="REST";},{getExecutor:function(_46,_47,svc){return new dojox.rpc.Rest(_47.name,(_47.contentType||svc._smd.contentType||"").match(/json|javascript/),null,function(id,_48){var _49=svc._getRequest(_47,[id]);_49.url=_49.target+(_49.data?"?"+_49.data:"");return _49;});}});}var drr;function _4a(_4b,_4c,_4d,id){_4b.addCallback(function(_4e){if(_4b.ioArgs.xhr&&_4d){_4d=_4b.ioArgs.xhr.getResponseHeader("Content-Range");_4b.fullLength=_4d&&(_4d=_4d.match(/\/(.*)/))&&parseInt(_4d[1]);}return _4e;});return _4b;};drr=dojox.rpc.Rest=function(_4f,_50,_51,_52){var _53;_53=function(id,_54){return drr._get(_53,id,_54);};_53.isJson=_50;_53._schema=_51;_53.cache={serialize:_50?((dojox.json&&dojox.json.ref)||dojo).toJson:function(_55){return _55;}};_53._getRequest=_52||function(id,_56){if(dojo.isObject(id)){id=dojo.objectToQuery(id);id=id?"?"+id:"";}if(_56&&_56.sort&&!_56.queryStr){id+=(id?"&":"?")+"sort(";for(var i=0;i<_56.sort.length;i++){var _57=_56.sort[i];id+=(i>0?",":"")+(_57.descending?"-":"+")+encodeURIComponent(_57.attribute);}id+=")";}var _58={url:_4f+(id==null?"":id),handleAs:_50?"json":"text",contentType:_50?"application/json":"text/plain",sync:dojox.rpc._sync,headers:{Accept:_50?"application/json,application/javascript":"*/*"}};if(_56&&(_56.start>=0||_56.count>=0)){_58.headers.Range="items="+(_56.start||"0")+"-"+((_56.count&&_56.count!=Infinity&&(_56.count+(_56.start||0)-1))||"");}dojox.rpc._sync=false;return _58;};function _59(_5a){_53[_5a]=function(id,_5b){return drr._change(_5a,_53,id,_5b);};};_59("put");_59("post");_59("delete");_53.servicePath=_4f;return _53;};drr._index={};drr._timeStamps={};drr._change=function(_5c,_5d,id,_5e){var _5f=_5d._getRequest(id);_5f[_5c+"Data"]=_5e;return _4a(dojo.xhr(_5c.toUpperCase(),_5f,true),_5d);};drr._get=function(_60,id,_61){_61=_61||{};return _4a(dojo.xhrGet(_60._getRequest(id,_61)),_60,(_61.start>=0||_61.count>=0),id);};})();}if(!dojo._hasResource["dojox.rpc.JsonRest"]){dojo._hasResource["dojox.rpc.JsonRest"]=true;dojo.provide("dojox.rpc.JsonRest");(function(){var _62=[];var _63=dojox.rpc.Rest;var jr;function _64(_65,_66,_67,_68){var _69=_66.ioArgs&&_66.ioArgs.xhr&&_66.ioArgs.xhr.getResponseHeader("Last-Modified");if(_69&&_63._timeStamps){_63._timeStamps[_68]=_69;}var _6a=_65._schema&&_65._schema.hrefProperty;if(_6a){dojox.json.ref.refAttribute=_6a;}_67=_67&&dojox.json.ref.resolveJson(_67,{defaultId:_68,index:_63._index,timeStamps:_69&&_63._timeStamps,time:_69,idPrefix:_65.servicePath.replace(/[^\/]*$/,""),idAttribute:jr.getIdAttribute(_65),schemas:jr.schemas,loader:jr._loader,idAsRef:_65.idAsRef,assignAbsoluteIds:true});dojox.json.ref.refAttribute="$ref";return _67;};jr=dojox.rpc.JsonRest={serviceClass:dojox.rpc.Rest,conflictDateHeader:"If-Unmodified-Since",commit:function(_6b){_6b=_6b||{};var _6c=[];var _6d={};var _6e=[];for(var i=0;i<_62.length;i++){var _6f=_62[i];var _70=_6f.object;var old=_6f.old;var _71=false;if(!(_6b.service&&(_70||old)&&(_70||old).__id.indexOf(_6b.service.servicePath))&&_6f.save){delete _70.__isDirty;if(_70){if(old){var _72;if((_72=_70.__id.match(/(.*)#.*/))){_70=_63._index[_72[1]];}if(!(_70.__id in _6d)){_6d[_70.__id]=_70;if(_6b.incrementalUpdates&&!_72){var _73=(typeof _6b.incrementalUpdates=="function"?_6b.incrementalUpdates:function(){_73={};for(var j in _70){if(_70.hasOwnProperty(j)){if(_70[j]!==old[j]){_73[j]=_70[j];}}else{if(old.hasOwnProperty(j)){return null;}}}return _73;})(_70,old);}if(_73){_6c.push({method:"post",target:_70,content:_73});}else{_6c.push({method:"put",target:_70,content:_70});}}}else{var _74=jr.getServiceAndId(_70.__id).service;var _75=jr.getIdAttribute(_74);if((_75 in _70)&&!_6b.alwaysPostNewItems){_6c.push({method:"put",target:_70,content:_70});}else{_6c.push({method:"post",target:{__id:_74.servicePath},content:_70});}}}else{if(old){_6c.push({method:"delete",target:old});}}_6e.push(_6f);_62.splice(i--,1);}}dojo.connect(_6b,"onError",function(){if(_6b.revertOnError!==false){var _76=_62;_62=_6e;var _77=0;jr.revert();_62=_76;}else{_62=dirtyObject.concat(_6e);}});jr.sendToServer(_6c,_6b);return _6c;},sendToServer:function(_78,_79){var _7a;var _7b=dojo.xhr;var _7c=_78.length;var i,_7d;var _7e;var _7f=this.conflictDateHeader;dojo.xhr=function(_80,_81){_81.headers=_81.headers||{};_81.headers["Transaction"]=_78.length-1==i?"commit":"open";if(_7f&&_7e){_81.headers[_7f]=_7e;}if(_7d){_81.headers["Content-ID"]="<"+_7d+">";}return _7b.apply(dojo,arguments);};for(i=0;i<_78.length;i++){var _82=_78[i];dojox.rpc.JsonRest._contentId=_82.content&&_82.content.__id;var _83=_82.method=="post";_7e=_82.method=="put"&&_63._timeStamps[_82.content.__id];if(_7e){_63._timeStamps[_82.content.__id]=(new Date())+"";}_7d=_83&&dojox.rpc.JsonRest._contentId;var _84=jr.getServiceAndId(_82.target.__id);var _85=_84.service;var dfd=_82.deferred=_85[_82.method](_84.id.replace(/#/,""),dojox.json.ref.toJson(_82.content,false,_85.servicePath,true));(function(_86,dfd,_87){dfd.addCallback(function(_88){try{var _89=dfd.ioArgs.xhr&&dfd.ioArgs.xhr.getResponseHeader("Location");if(_89){var _8a=_89.match(/(^\w+:\/\/)/)&&_89.indexOf(_87.servicePath);_89=_8a>0?_89.substring(_8a):(_87.servicePath+_89).replace(/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/,"$2$3");_86.__id=_89;_63._index[_89]=_86;}_88=_64(_87,dfd,_88,_86&&_86.__id);}catch(e){}if(!(--_7c)){if(_79.onComplete){_79.onComplete.call(_79.scope,_78);}}return _88;});})(_82.content,dfd,_85);dfd.addErrback(function(_8b){_7c=-1;_79.onError.call(_79.scope,_8b);});}dojo.xhr=_7b;},getDirtyObjects:function(){return _62;},revert:function(_8c){for(var i=_62.length;i>0;){i--;var _8d=_62[i];var _8e=_8d.object;var old=_8d.old;var _8f=dojox.data._getStoreForItem(_8e||old);if(!(_8c&&(_8e||old)&&(_8e||old).__id.indexOf(_8c.servicePath))){if(_8e&&old){for(var j in old){if(old.hasOwnProperty(j)&&_8e[j]!==old[j]){if(_8f){_8f.onSet(_8e,j,_8e[j],old[j]);}_8e[j]=old[j];}}for(j in _8e){if(!old.hasOwnProperty(j)){if(_8f){_8f.onSet(_8e,j,_8e[j]);}delete _8e[j];}}}else{if(!old){if(_8f){_8f.onDelete(_8e);}}else{if(_8f){_8f.onNew(old);}}}delete (_8e||old).__isDirty;_62.splice(i,1);}}},changing:function(_90,_91){if(!_90.__id){return;}_90.__isDirty=true;for(var i=0;i<_62.length;i++){var _92=_62[i];if(_90==_92.object){if(_91){_92.object=false;if(!this._saveNotNeeded){_92.save=true;}}return;}}var old=_90 instanceof Array?[]:{};for(i in _90){if(_90.hasOwnProperty(i)){old[i]=_90[i];}}_62.push({object:!_91&&_90,old:old,save:!this._saveNotNeeded});},deleteObject:function(_93){this.changing(_93,true);},getConstructor:function(_94,_95){if(typeof _94=="string"){var _96=_94;_94=new dojox.rpc.Rest(_94,true);this.registerService(_94,_96,_95);}if(_94._constructor){return _94._constructor;}_94._constructor=function(_97){var _98=this;var _99=arguments;var _9a;var _9b;function _9c(_9d){if(_9d){_9c(_9d["extends"]);_9a=_9d.properties;for(var i in _9a){var _9e=_9a[i];if(_9e&&(typeof _9e=="object")&&("default" in _9e)){_98[i]=_9e["default"];}}}if(_9d&&_9d.prototype&&_9d.prototype.initialize){_9b=true;_9d.prototype.initialize.apply(_98,_99);}};_9c(_94._schema);if(!_9b&&_97&&typeof _97=="object"){dojo.mixin(_98,_97);}var _9f=jr.getIdAttribute(_94);_63._index[this.__id=this.__clientId=_94.servicePath+(this[_9f]||Math.random().toString(16).substring(2,14)+"@"+((dojox.rpc.Client&&dojox.rpc.Client.clientId)||"client"))]=this;if(dojox.json.schema&&_9a){dojox.json.schema.mustBeValid(dojox.json.schema.validate(this,_94._schema));}_62.push({object:this,save:true});};return dojo.mixin(_94._constructor,_94._schema,{load:_94});},fetch:function(_a0){var _a1=jr.getServiceAndId(_a0);return this.byId(_a1.service,_a1.id);},getIdAttribute:function(_a2){var _a3=_a2._schema;var _a4;if(_a3){if(!(_a4=_a3._idAttr)){for(var i in _a3.properties){if(_a3.properties[i].identity||(_a3.properties[i].link=="self")){_a3._idAttr=_a4=i;}}}}return _a4||"id";},getServiceAndId:function(_a5){var _a6="";for(var _a7 in jr.services){if((_a5.substring(0,_a7.length)==_a7)&&(_a7.length>=_a6.length)){_a6=_a7;}}if(_a6){return {service:jr.services[_a6],id:_a5.substring(_a6.length)};}var _a8=_a5.match(/^(.*\/)([^\/]*)$/);return {service:new jr.serviceClass(_a8[1],true),id:_a8[2]};},services:{},schemas:{},registerService:function(_a9,_aa,_ab){_aa=_a9.servicePath=_aa||_a9.servicePath;_a9._schema=jr.schemas[_aa]=_ab||_a9._schema||{};jr.services[_aa]=_a9;},byId:function(_ac,id){var _ad,_ae=_63._index[(_ac.servicePath||"")+id];if(_ae&&!_ae._loadObject){_ad=new dojo.Deferred();_ad.callback(_ae);return _ad;}return this.query(_ac,id);},query:function(_af,id,_b0){var _b1=_af(id,_b0);_b1.addCallback(function(_b2){if(_b2.nodeType&&_b2.cloneNode){return _b2;}return _64(_af,_b1,_b2,typeof id!="string"||(_b0&&(_b0.start||_b0.count))?undefined:id);});return _b1;},_loader:function(_b3){var _b4=jr.getServiceAndId(this.__id);var _b5=this;jr.query(_b4.service,_b4.id).addBoth(function(_b6){if(_b6==_b5){delete _b6.$ref;delete _b6._loadObject;}else{_b5._loadObject=function(_b7){_b7(_b6);};}_b3(_b6);});},isDirty:function(_b8){if(!_b8){return !!_62.length;}return _b8.__isDirty;}};})();}if(!dojo._hasResource["persevere.persevere"]){dojo._hasResource["persevere.persevere"]=true;dojo.provide("persevere.persevere");(function(){var jr=dojox.rpc.JsonRest;var _b9=null;var _ba=dojo.xhr;dojo.xhr=function(_bb,_bc,_bd){dfd=_ba(_bb,_bc,_bd);dfd.addCallback(function(){_b9=dfd.ioArgs.xhr.getResponseHeader("Username");});return dfd;};function _be(_bf,_c0){_bf._loadObject(function(_c1){delete _bf._loadObject;_c0(_c1);});};pjs={commit:function(_c2){jr.commit({onComplete:_c2});},rollback:jr.revert,changing:jr.changing,get:function(_c3,_c4,_c5){var _c6=_c3[_c4];if(_c5){if(_c6&&_c6._loadObject){_be(_c6,_c5);}else{_c5(_c6);}}return _c6;},set:function(_c7,_c8,_c9){jr.changing(_c7);_c7[_c8]=_c9;},getId:function(_ca){return _ca.__id;},load:function(id,_cb){if(id.match(/[^\/\w]|(\/$)/)){delete dojox.rpc.Rest._index[id];}jr.fetch(id).addBoth(function(_cc){_cb(_cc);return _cc;});},remove:function(_cd){jr.deleteObject(_cd);},isPersisted:function(_ce){return !!_ce.__id;},getUserName:function(){return _b9;},loadClasses:function(_cf,_d0,_d1){_cf=(_cf&&(_cf.match(/\/$/)?_cf:(_cf+"/")))||"/";if(_cf.match(/^\w*:\/\//)){dojox.io.xhrWindowNamePlugin(_cf,dojox.io.xhrPlugins.fullHttpAdapter,true);}var _d2=dojox.rpc.Rest(_cf,true);var _d3=dojox.rpc._sync;dojox.rpc._sync=!_d0;var dfd=_d2("root");var _d4;_d1=_d1||window;dfd.addBoth(function(_d5){for(var i in _d5){if(typeof _d5[i]=="object"){_d1[i]=_d5[i]=dojox.rpc.JsonRest.getConstructor(new dojo._Url(_cf,i)+"/",_d5[i]);}}return (_d4=_d5);});dojox.rpc._sync=_d3;return _d0?dfd.addBoth(_d0):_d4;}};})();}
