/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is a compiled version of Dojo, built for deployment and not for
	development. To get an editable version, please visit:

		http://dojotoolkit.org

	for documentation and information on getting the source.
*/

if(!dojo._hasResource["dojox.data.ServiceStore"]){dojo._hasResource["dojox.data.ServiceStore"]=true;dojo.provide("dojox.data.ServiceStore");dojo.declare("dojox.data.ServiceStore",dojox.data.ClientFilter,{service:null,constructor:function(_1){this.byId=this.fetchItemByIdentity;this._index={};if(_1){dojo.mixin(this,_1);}this.idAttribute=(_1&&_1.idAttribute)||(this.schema&&this.schema._idAttr);this.labelAttribute=this.labelAttribute||"label";},schema:null,idAttribute:"id",syncMode:false,estimateCountFactor:1,getSchema:function(){return this.schema;},loadLazyValues:true,getValue:function(_2,_3,_4){var _5=_2[_3];return _5||(_3 in _2?_5:_2._loadObject?(dojox.rpc._sync=true)&&arguments.callee.call(this,dojox.data.ServiceStore.prototype.loadItem({item:_2})||{},_3,_4):_4);},getValues:function(_6,_7){var _8=this.getValue(_6,_7);return _8 instanceof Array?_8:_8===undefined?[]:[_8];},getAttributes:function(_9){var _a=[];for(var i in _9){if(_9.hasOwnProperty(i)&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")){_a.push(i);}}return _a;},hasAttribute:function(_b,_c){return _c in _b;},containsValue:function(_d,_e,_f){return dojo.indexOf(this.getValues(_d,_e),_f)>-1;},isItem:function(_10){return (typeof _10=="object")&&_10&&!(_10 instanceof Date);},isItemLoaded:function(_11){return _11&&!_11._loadObject;},loadItem:function(_12){var _13;if(_12.item._loadObject){_12.item._loadObject(function(_14){_13=_14;delete _13._loadObject;var _15=_14 instanceof Error?_12.onError:_12.onItem;if(_15){_15.call(_12.scope,_14);}});}else{if(_12.onItem){_12.onItem.call(_12.scope,_12.item);}}return _13;},_currentId:0,_processResults:function(_16,_17){if(_16&&typeof _16=="object"){var id=_16.__id;if(!id){if(this.idAttribute){id=_16[this.idAttribute];}else{id=this._currentId++;}if(id!==undefined){var _18=this._index[id];if(_18){for(var j in _18){delete _18[j];}_16=dojo.mixin(_18,_16);}_16.__id=id;this._index[id]=_16;}}for(var i in _16){_16[i]=this._processResults(_16[i],_17).items;}var _19=_16.length;}return {totalCount:_17.request.count==_19?(_17.request.start||0)+_19*this.estimateCountFactor:_19,items:_16};},close:function(_1a){return _1a&&_1a.abort&&_1a.abort();},fetch:function(_1b){_1b=_1b||{};if("syncMode" in _1b?_1b.syncMode:this.syncMode){dojox.rpc._sync=true;}var _1c=this;var _1d=_1b.scope||_1c;var _1e=this.cachingFetch?this.cachingFetch(_1b):this._doQuery(_1b);_1e.request=_1b;_1e.addCallback(function(_1f){if(_1b.clientFetch){_1f=_1c.clientSideFetch({query:_1b.clientFetch,sort:_1b.sort,start:_1b.start,count:_1b.count},_1f);}var _20=_1c._processResults(_1f,_1e);_1f=_1b.results=_20.items;if(_1b.onBegin){_1b.onBegin.call(_1d,_20.totalCount,_1b);}if(_1b.onItem){for(var i=0;i<_1f.length;i++){_1b.onItem.call(_1d,_1f[i],_1b);}}if(_1b.onComplete){_1b.onComplete.call(_1d,_1b.onItem?null:_1f,_1b);}return _1f;});_1e.addErrback(_1b.onError&&function(err){return _1b.onError.call(_1d,err,_1b);});_1b.abort=function(){_1e.cancel();};_1b.store=this;return _1b;},_doQuery:function(_21){var _22=typeof _21.queryStr=="string"?_21.queryStr:_21.query;return this.service(_22);},getFeatures:function(){return {"dojo.data.api.Read":true,"dojo.data.api.Identity":true,"dojo.data.api.Schema":this.schema};},getLabel:function(_23){return this.getValue(_23,this.labelAttribute);},getLabelAttributes:function(_24){return [this.labelAttribute];},getIdentity:function(_25){return _25.__id;},getIdentityAttributes:function(_26){return [this.idAttribute];},fetchItemByIdentity:function(_27){var _28=this._index[(_27._prefix||"")+_27.identity];if(_28){if(_28._loadObject){_27.item=_28;return this.loadItem(_27);}else{if(_27.onItem){_27.onItem.call(_27.scope,_28);}}}else{return this.fetch({query:_27.identity,onComplete:_27.onItem,onError:_27.onError,scope:_27.scope}).results;}return _28;}});}if(!dojo._hasResource["dojo.date.stamp"]){dojo._hasResource["dojo.date.stamp"]=true;dojo.provide("dojo.date.stamp");dojo.date.stamp.fromISOString=function(_29,_2a){if(!dojo.date.stamp._isoRegExp){dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _2b=dojo.date.stamp._isoRegExp.exec(_29),_2c=null;if(_2b){_2b.shift();if(_2b[1]){_2b[1]--;}if(_2b[6]){_2b[6]*=1000;}if(_2a){_2a=new Date(_2a);dojo.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(_2d){return _2a["get"+_2d]();}).forEach(function(_2e,_2f){if(_2b[_2f]===undefined){_2b[_2f]=_2e;}});}_2c=new Date(_2b[0]||1970,_2b[1]||0,_2b[2]||1,_2b[3]||0,_2b[4]||0,_2b[5]||0,_2b[6]||0);if(_2b[0]<100){_2c.setFullYear(_2b[0]||1970);}var _30=0,_31=_2b[7]&&_2b[7].charAt(0);if(_31!="Z"){_30=((_2b[8]||0)*60)+(Number(_2b[9])||0);if(_31!="-"){_30*=-1;}}if(_31){_30-=_2c.getTimezoneOffset();}if(_30){_2c.setTime(_2c.getTime()+_30*60000);}}return _2c;};dojo.date.stamp.toISOString=function(_32,_33){var _34=function(n){return (n<10)?"0"+n:n;};_33=_33||{};var _35=[],_36=_33.zulu?"getUTC":"get",_37="";if(_33.selector!="time"){var _38=_32[_36+"FullYear"]();_37=["0000".substr((_38+"").length)+_38,_34(_32[_36+"Month"]()+1),_34(_32[_36+"Date"]())].join("-");}_35.push(_37);if(_33.selector!="date"){var _39=[_34(_32[_36+"Hours"]()),_34(_32[_36+"Minutes"]()),_34(_32[_36+"Seconds"]())].join(":");var _3a=_32[_36+"Milliseconds"]();if(_33.milliseconds){_39+="."+(_3a<100?"0":"")+_34(_3a);}if(_33.zulu){_39+="Z";}else{if(_33.selector!="time"){var _3b=_32.getTimezoneOffset();var _3c=Math.abs(_3b);_39+=(_3b>0?"-":"+")+_34(Math.floor(_3c/60))+":"+_34(_3c%60);}}_35.push(_39);}return _35.join("T");};}if(!dojo._hasResource["dojox.json.ref"]){dojo._hasResource["dojox.json.ref"]=true;dojo.provide("dojox.json.ref");dojox.json.ref={resolveJson:function(_3d,_3e){_3e=_3e||{};var _3f=_3e.idAttribute||"id";var _40=this.refAttribute;var _41=_3e.idAsRef;var _42=_3e.idPrefix||"";var _43=_3e.assignAbsoluteIds;var _44=_3e.index||{};var _45=_3e.timeStamps;var ref,_46=[];var _47=/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/;var _48=this._addProp;var F=function(){};function _49(it,_4a,_4b,_4c,_4d,_4e){var i,_4f,val,id=_3f in it?it[_3f]:_4b;if(_3f in it||((id!==undefined)&&_4c)){id=(_42+id).replace(_47,"$2$3");}var _50=_4e||it;if(id!==undefined){if(_43){it.__id=id;}if(_3e.schemas&&(!(it instanceof Array))&&(val=id.match(/^(.+\/)[^\.\[]*$/))){_4d=_3e.schemas[val[1]];}if(_44[id]&&((it instanceof Array)==(_44[id] instanceof Array))){_50=_44[id];delete _50.$ref;delete _50._loadObject;_4f=true;}else{var _51=_4d&&_4d.prototype;if(_51){F.prototype=_51;_50=new F();}}_44[id]=_50;if(_45){_45[id]=_3e.time;}}while(_4d){var _52=_4d.properties;if(_52){for(i in it){var _53=_52[i];if(_53&&_53.format=="date-time"&&typeof it[i]=="string"){it[i]=dojo.date.stamp.fromISOString(it[i]);}}}_4d=_4d["extends"];}var _54=it.length;for(i in it){if(i==_54){break;}if(it.hasOwnProperty(i)){val=it[i];if((typeof val=="object")&&val&&!(val instanceof Date)&&i!="__parent"){ref=val[_40]||(_41&&val[_3f]);if(!ref||!val.__parent){val.__parent=it;}if(ref){delete it[i];var _55=ref.toString().replace(/(#)([^\.\[])/,"$1.$2").match(/(^([^\[]*\/)?[^#\.\[]*)#?([\.\[].*)?/);if((ref=(_55[1]=="$"||_55[1]=="this"||_55[1]=="")?_3d:_44[(_42+_55[1]).replace(_47,"$2$3")])){if(_55[3]){_55[3].replace(/(\[([^\]]+)\])|(\.?([^\.\[]+))/g,function(t,a,b,c,d){ref=ref&&ref[b?b.replace(/[\"\'\\]/,""):d];});}}if(ref){val=ref;}else{if(!_4a){var _56;if(!_56){_46.push(_50);}_56=true;val=_49(val,false,val[_40],true,_53);val._loadObject=_3e.loader;}}}else{if(!_4a){val=_49(val,_46==it,id===undefined?undefined:_48(id,i),false,_53,_50!=it&&typeof _50[i]=="object"&&_50[i]);}}}it[i]=val;if(_50!=it&&!_50.__isDirty){var old=_50[i];_50[i]=val;if(_4f&&val!==old&&!_50._loadObject&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")&&i!="$ref"&&!(val instanceof Date&&old instanceof Date&&val.getTime()==old.getTime())&&!(typeof val=="function"&&typeof old=="function"&&val.toString()==old.toString())&&_44.onUpdate){_44.onUpdate(_50,i,old,val);}}}}if(_4f&&(_3f in it)){for(i in _50){if(!_50.__isDirty&&_50.hasOwnProperty(i)&&!it.hasOwnProperty(i)&&!(i.charAt(0)=="_"&&i.charAt(1)=="_")&&!(_50 instanceof Array&&isNaN(i))){if(_44.onUpdate&&i!="_loadObject"&&i!="_idAttr"){_44.onUpdate(_50,i,_50[i],undefined);}delete _50[i];while(_50 instanceof Array&&_50.length&&_50[_50.length-1]===undefined){_50.length--;}}}}else{if(_44.onLoad){_44.onLoad(_50);}}return _50;};if(_3d&&typeof _3d=="object"){_3d=_49(_3d,false,_3e.defaultId,true);_49(_46,false);}return _3d;},fromJson:function(str,_57){function ref(_58){var _59={};_59[this.refAttribute]=_58;return _59;};try{var _5a=eval("("+str+")");}catch(e){throw new SyntaxError("Invalid JSON string: "+e.message+" parsing: "+str);}if(_5a){return this.resolveJson(_5a,_57);}return _5a;},toJson:function(it,_5b,_5c,_5d){var _5e=this._useRefs;var _5f=this._addProp;var _60=this.refAttribute;_5c=_5c||"";var _61={};var _62={};function _63(it,_64,_65){if(typeof it=="object"&&it){var _66;if(it instanceof Date){return "\""+dojo.date.stamp.toISOString(it,{zulu:true})+"\"";}var id=it.__id;if(id){if(_64!="#"&&((_5e&&!id.match(/#/))||_61[id])){var ref=id;if(id.charAt(0)!="#"){if(it.__clientId==id){ref="cid:"+id;}else{if(id.substring(0,_5c.length)==_5c){ref=id.substring(_5c.length);}else{ref=id;}}}var _67={};_67[_60]=ref;return _63(_67,"#");}_64=id;}else{it.__id=_64;_62[_64]=it;}_61[_64]=it;_65=_65||"";var _68=_5b?_65+dojo.toJsonIndentStr:"";var _69=_5b?"\n":"";var sep=_5b?" ":"";if(it instanceof Array){var res=dojo.map(it,function(obj,i){var val=_63(obj,_5f(_64,i),_68);if(typeof val!="string"){val="undefined";}return _69+_68+val;});return "["+res.join(","+sep)+_69+_65+"]";}var _6a=[];for(var i in it){if(it.hasOwnProperty(i)){var _6b;if(typeof i=="number"){_6b="\""+i+"\"";}else{if(typeof i=="string"&&(i.charAt(0)!="_"||i.charAt(1)!="_")){_6b=dojo._escapeString(i);}else{continue;}}var val=_63(it[i],_5f(_64,i),_68);if(typeof val!="string"){continue;}_6a.push(_69+_68+_6b+":"+sep+val);}}return "{"+_6a.join(","+sep)+_69+_65+"}";}else{if(typeof it=="function"&&dojox.json.ref.serializeFunctions){return it.toString();}}return dojo.toJson(it);};var _6c=_63(it,"#","");if(!_5d){for(var i in _62){delete _62[i].__id;}}return _6c;},_addProp:function(id,_6d){return id+(id.match(/#/)?id.length==1?"":".":"#")+_6d;},refAttribute:"$ref",_useRefs:false,serializeFunctions:false};}if(!dojo._hasResource["dojox.rpc.Rest"]){dojo._hasResource["dojox.rpc.Rest"]=true;dojo.provide("dojox.rpc.Rest");(function(){if(dojox.rpc&&dojox.rpc.transportRegistry){dojox.rpc.transportRegistry.register("REST",function(str){return str=="REST";},{getExecutor:function(_6e,_6f,svc){return new dojox.rpc.Rest(_6f.name,(_6f.contentType||svc._smd.contentType||"").match(/json|javascript/),null,function(id,_70){var _71=svc._getRequest(_6f,[id]);_71.url=_71.target+(_71.data?"?"+_71.data:"");return _71;});}});}var drr;function _72(_73,_74,_75,id){_73.addCallback(function(_76){if(_73.ioArgs.xhr&&_75){_75=_73.ioArgs.xhr.getResponseHeader("Content-Range");_73.fullLength=_75&&(_75=_75.match(/\/(.*)/))&&parseInt(_75[1]);}return _76;});return _73;};drr=dojox.rpc.Rest=function(_77,_78,_79,_7a){var _7b;_7b=function(id,_7c){return drr._get(_7b,id,_7c);};_7b.isJson=_78;_7b._schema=_79;_7b.cache={serialize:_78?((dojox.json&&dojox.json.ref)||dojo).toJson:function(_7d){return _7d;}};_7b._getRequest=_7a||function(id,_7e){if(dojo.isObject(id)){id=dojo.objectToQuery(id);id=id?"?"+id:"";}if(_7e&&_7e.sort&&!_7e.queryStr){id+=(id?"&":"?")+"sort(";for(var i=0;i<_7e.sort.length;i++){var _7f=_7e.sort[i];id+=(i>0?",":"")+(_7f.descending?"-":"+")+encodeURIComponent(_7f.attribute);}id+=")";}var _80={url:_77+(id==null?"":id),handleAs:_78?"json":"text",contentType:_78?"application/json":"text/plain",sync:dojox.rpc._sync,headers:{Accept:_78?"application/json,application/javascript":"*/*"}};if(_7e&&(_7e.start>=0||_7e.count>=0)){_80.headers.Range="items="+(_7e.start||"0")+"-"+((_7e.count&&_7e.count!=Infinity&&(_7e.count+(_7e.start||0)-1))||"");}dojox.rpc._sync=false;return _80;};function _81(_82){_7b[_82]=function(id,_83){return drr._change(_82,_7b,id,_83);};};_81("put");_81("post");_81("delete");_7b.servicePath=_77;return _7b;};drr._index={};drr._timeStamps={};drr._change=function(_84,_85,id,_86){var _87=_85._getRequest(id);_87[_84+"Data"]=_86;return _72(dojo.xhr(_84.toUpperCase(),_87,true),_85);};drr._get=function(_88,id,_89){_89=_89||{};return _72(dojo.xhrGet(_88._getRequest(id,_89)),_88,(_89.start>=0||_89.count>=0),id);};})();}if(!dojo._hasResource["dojox.rpc.JsonRest"]){dojo._hasResource["dojox.rpc.JsonRest"]=true;dojo.provide("dojox.rpc.JsonRest");(function(){var _8a=[];var _8b=dojox.rpc.Rest;var jr;function _8c(_8d,_8e,_8f,_90){var _91=_8e.ioArgs&&_8e.ioArgs.xhr&&_8e.ioArgs.xhr.getResponseHeader("Last-Modified");if(_91&&_8b._timeStamps){_8b._timeStamps[_90]=_91;}var _92=_8d._schema&&_8d._schema.hrefProperty;if(_92){dojox.json.ref.refAttribute=_92;}_8f=_8f&&dojox.json.ref.resolveJson(_8f,{defaultId:_90,index:_8b._index,timeStamps:_91&&_8b._timeStamps,time:_91,idPrefix:_8d.servicePath.replace(/[^\/]*$/,""),idAttribute:jr.getIdAttribute(_8d),schemas:jr.schemas,loader:jr._loader,idAsRef:_8d.idAsRef,assignAbsoluteIds:true});dojox.json.ref.refAttribute="$ref";return _8f;};jr=dojox.rpc.JsonRest={serviceClass:dojox.rpc.Rest,conflictDateHeader:"If-Unmodified-Since",commit:function(_93){_93=_93||{};var _94=[];var _95={};var _96=[];for(var i=0;i<_8a.length;i++){var _97=_8a[i];var _98=_97.object;var old=_97.old;var _99=false;if(!(_93.service&&(_98||old)&&(_98||old).__id.indexOf(_93.service.servicePath))&&_97.save){delete _98.__isDirty;if(_98){if(old){var _9a;if((_9a=_98.__id.match(/(.*)#.*/))){_98=_8b._index[_9a[1]];}if(!(_98.__id in _95)){_95[_98.__id]=_98;if(_93.incrementalUpdates&&!_9a){var _9b=(typeof _93.incrementalUpdates=="function"?_93.incrementalUpdates:function(){_9b={};for(var j in _98){if(_98.hasOwnProperty(j)){if(_98[j]!==old[j]){_9b[j]=_98[j];}}else{if(old.hasOwnProperty(j)){return null;}}}return _9b;})(_98,old);}if(_9b){_94.push({method:"post",target:_98,content:_9b});}else{_94.push({method:"put",target:_98,content:_98});}}}else{var _9c=jr.getServiceAndId(_98.__id).service;var _9d=jr.getIdAttribute(_9c);if((_9d in _98)&&!_93.alwaysPostNewItems){_94.push({method:"put",target:_98,content:_98});}else{_94.push({method:"post",target:{__id:_9c.servicePath},content:_98});}}}else{if(old){_94.push({method:"delete",target:old});}}_96.push(_97);_8a.splice(i--,1);}}dojo.connect(_93,"onError",function(){if(_93.revertOnError!==false){var _9e=_8a;_8a=_96;var _9f=0;jr.revert();_8a=_9e;}else{_8a=dirtyObject.concat(_96);}});jr.sendToServer(_94,_93);return _94;},sendToServer:function(_a0,_a1){var _a2;var _a3=dojo.xhr;var _a4=_a0.length;var i,_a5;var _a6;var _a7=this.conflictDateHeader;dojo.xhr=function(_a8,_a9){_a9.headers=_a9.headers||{};_a9.headers["Transaction"]=_a0.length-1==i?"commit":"open";if(_a7&&_a6){_a9.headers[_a7]=_a6;}if(_a5){_a9.headers["Content-ID"]="<"+_a5+">";}return _a3.apply(dojo,arguments);};for(i=0;i<_a0.length;i++){var _aa=_a0[i];dojox.rpc.JsonRest._contentId=_aa.content&&_aa.content.__id;var _ab=_aa.method=="post";_a6=_aa.method=="put"&&_8b._timeStamps[_aa.content.__id];if(_a6){_8b._timeStamps[_aa.content.__id]=(new Date())+"";}_a5=_ab&&dojox.rpc.JsonRest._contentId;var _ac=jr.getServiceAndId(_aa.target.__id);var _ad=_ac.service;var dfd=_aa.deferred=_ad[_aa.method](_ac.id.replace(/#/,""),dojox.json.ref.toJson(_aa.content,false,_ad.servicePath,true));(function(_ae,dfd,_af){dfd.addCallback(function(_b0){try{var _b1=dfd.ioArgs.xhr&&dfd.ioArgs.xhr.getResponseHeader("Location");if(_b1){var _b2=_b1.match(/(^\w+:\/\/)/)&&_b1.indexOf(_af.servicePath);_b1=_b2>0?_b1.substring(_b2):(_af.servicePath+_b1).replace(/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/,"$2$3");_ae.__id=_b1;_8b._index[_b1]=_ae;}_b0=_8c(_af,dfd,_b0,_ae&&_ae.__id);}catch(e){}if(!(--_a4)){if(_a1.onComplete){_a1.onComplete.call(_a1.scope,_a0);}}return _b0;});})(_aa.content,dfd,_ad);dfd.addErrback(function(_b3){_a4=-1;_a1.onError.call(_a1.scope,_b3);});}dojo.xhr=_a3;},getDirtyObjects:function(){return _8a;},revert:function(_b4){for(var i=_8a.length;i>0;){i--;var _b5=_8a[i];var _b6=_b5.object;var old=_b5.old;var _b7=dojox.data._getStoreForItem(_b6||old);if(!(_b4&&(_b6||old)&&(_b6||old).__id.indexOf(_b4.servicePath))){if(_b6&&old){for(var j in old){if(old.hasOwnProperty(j)&&_b6[j]!==old[j]){if(_b7){_b7.onSet(_b6,j,_b6[j],old[j]);}_b6[j]=old[j];}}for(j in _b6){if(!old.hasOwnProperty(j)){if(_b7){_b7.onSet(_b6,j,_b6[j]);}delete _b6[j];}}}else{if(!old){if(_b7){_b7.onDelete(_b6);}}else{if(_b7){_b7.onNew(old);}}}delete (_b6||old).__isDirty;_8a.splice(i,1);}}},changing:function(_b8,_b9){if(!_b8.__id){return;}_b8.__isDirty=true;for(var i=0;i<_8a.length;i++){var _ba=_8a[i];if(_b8==_ba.object){if(_b9){_ba.object=false;if(!this._saveNotNeeded){_ba.save=true;}}return;}}var old=_b8 instanceof Array?[]:{};for(i in _b8){if(_b8.hasOwnProperty(i)){old[i]=_b8[i];}}_8a.push({object:!_b9&&_b8,old:old,save:!this._saveNotNeeded});},deleteObject:function(_bb){this.changing(_bb,true);},getConstructor:function(_bc,_bd){if(typeof _bc=="string"){var _be=_bc;_bc=new dojox.rpc.Rest(_bc,true);this.registerService(_bc,_be,_bd);}if(_bc._constructor){return _bc._constructor;}_bc._constructor=function(_bf){var _c0=this;var _c1=arguments;var _c2;var _c3;function _c4(_c5){if(_c5){_c4(_c5["extends"]);_c2=_c5.properties;for(var i in _c2){var _c6=_c2[i];if(_c6&&(typeof _c6=="object")&&("default" in _c6)){_c0[i]=_c6["default"];}}}if(_c5&&_c5.prototype&&_c5.prototype.initialize){_c3=true;_c5.prototype.initialize.apply(_c0,_c1);}};_c4(_bc._schema);if(!_c3&&_bf&&typeof _bf=="object"){dojo.mixin(_c0,_bf);}var _c7=jr.getIdAttribute(_bc);_8b._index[this.__id=this.__clientId=_bc.servicePath+(this[_c7]||Math.random().toString(16).substring(2,14)+"@"+((dojox.rpc.Client&&dojox.rpc.Client.clientId)||"client"))]=this;if(dojox.json.schema&&_c2){dojox.json.schema.mustBeValid(dojox.json.schema.validate(this,_bc._schema));}_8a.push({object:this,save:true});};return dojo.mixin(_bc._constructor,_bc._schema,{load:_bc});},fetch:function(_c8){var _c9=jr.getServiceAndId(_c8);return this.byId(_c9.service,_c9.id);},getIdAttribute:function(_ca){var _cb=_ca._schema;var _cc;if(_cb){if(!(_cc=_cb._idAttr)){for(var i in _cb.properties){if(_cb.properties[i].identity||(_cb.properties[i].link=="self")){_cb._idAttr=_cc=i;}}}}return _cc||"id";},getServiceAndId:function(_cd){var _ce="";for(var _cf in jr.services){if((_cd.substring(0,_cf.length)==_cf)&&(_cf.length>=_ce.length)){_ce=_cf;}}if(_ce){return {service:jr.services[_ce],id:_cd.substring(_ce.length)};}var _d0=_cd.match(/^(.*\/)([^\/]*)$/);return {service:new jr.serviceClass(_d0[1],true),id:_d0[2]};},services:{},schemas:{},registerService:function(_d1,_d2,_d3){_d2=_d1.servicePath=_d2||_d1.servicePath;_d1._schema=jr.schemas[_d2]=_d3||_d1._schema||{};jr.services[_d2]=_d1;},byId:function(_d4,id){var _d5,_d6=_8b._index[(_d4.servicePath||"")+id];if(_d6&&!_d6._loadObject){_d5=new dojo.Deferred();_d5.callback(_d6);return _d5;}return this.query(_d4,id);},query:function(_d7,id,_d8){var _d9=_d7(id,_d8);_d9.addCallback(function(_da){if(_da.nodeType&&_da.cloneNode){return _da;}return _8c(_d7,_d9,_da,typeof id!="string"||(_d8&&(_d8.start||_d8.count))?undefined:id);});return _d9;},_loader:function(_db){var _dc=jr.getServiceAndId(this.__id);var _dd=this;jr.query(_dc.service,_dc.id).addBoth(function(_de){if(_de==_dd){delete _de.$ref;delete _de._loadObject;}else{_dd._loadObject=function(_df){_df(_de);};}_db(_de);});},isDirty:function(_e0){if(!_e0){return !!_8a.length;}return _e0.__isDirty;}};})();}if(!dojo._hasResource["dojox.data.JsonRestStore"]){dojo._hasResource["dojox.data.JsonRestStore"]=true;dojo.provide("dojox.data.JsonRestStore");dojo.declare("dojox.data.JsonRestStore",dojox.data.ServiceStore,{constructor:function(_e1){dojo.connect(dojox.rpc.Rest._index,"onUpdate",this,function(obj,_e2,_e3,_e4){var _e5=this.service.servicePath;if(!obj.__id){console.log("no id on updated object ",obj);}else{if(obj.__id.substring(0,_e5.length)==_e5){this.onSet(obj,_e2,_e3,_e4);}}});this.idAttribute=this.idAttribute||"id";if(typeof _e1.target=="string"){_e1.target=_e1.target.match(/\/$/)||this.allowNoTrailingSlash?_e1.target:(_e1.target+"/");if(!this.service){this.service=dojox.rpc.JsonRest.services[_e1.target]||dojox.rpc.Rest(_e1.target,true);}}dojox.rpc.JsonRest.registerService(this.service,_e1.target,this.schema);this.schema=this.service._schema=this.schema||this.service._schema||{};this.service._store=this;this.service.idAsRef=this.idAsRef;this.schema._idAttr=this.idAttribute;var _e6=dojox.rpc.JsonRest.getConstructor(this.service);var _e7=this;this._constructor=function(_e8){_e6.call(this,_e8);_e7.onNew(this);};this._constructor.prototype=_e6.prototype;this._index=dojox.rpc.Rest._index;},loadReferencedSchema:true,idAsRef:false,referenceIntegrity:true,target:"",allowNoTrailingSlash:false,newItem:function(_e9,_ea){_e9=new this._constructor(_e9);if(_ea){var _eb=this.getValue(_ea.parent,_ea.attribute,[]);_eb=_eb.concat([_e9]);_e9.__parent=_eb;this.setValue(_ea.parent,_ea.attribute,_eb);}return _e9;},deleteItem:function(_ec){var _ed=[];var _ee=dojox.data._getStoreForItem(_ec)||this;if(this.referenceIntegrity){dojox.rpc.JsonRest._saveNotNeeded=true;var _ef=dojox.rpc.Rest._index;var _f0=function(_f1){var _f2;_ed.push(_f1);_f1.__checked=1;for(var i in _f1){if(i.substring(0,2)!="__"){var _f3=_f1[i];if(_f3==_ec){if(_f1!=_ef){if(_f1 instanceof Array){(_f2=_f2||[]).push(i);}else{(dojox.data._getStoreForItem(_f1)||_ee).unsetAttribute(_f1,i);}}}else{if((typeof _f3=="object")&&_f3){if(!_f3.__checked){_f0(_f3);}if(typeof _f3.__checked=="object"&&_f1!=_ef){(dojox.data._getStoreForItem(_f1)||_ee).setValue(_f1,i,_f3.__checked);}}}}}if(_f2){i=_f2.length;_f1=_f1.__checked=_f1.concat();while(i--){_f1.splice(_f2[i],1);}return _f1;}return null;};_f0(_ef);dojox.rpc.JsonRest._saveNotNeeded=false;var i=0;while(_ed[i]){delete _ed[i++].__checked;}}dojox.rpc.JsonRest.deleteObject(_ec);_ee.onDelete(_ec);},changing:function(_f4,_f5){dojox.rpc.JsonRest.changing(_f4,_f5);},setValue:function(_f6,_f7,_f8){var old=_f6[_f7];var _f9=_f6.__id?dojox.data._getStoreForItem(_f6):this;if(dojox.json.schema&&_f9.schema&&_f9.schema.properties){dojox.json.schema.mustBeValid(dojox.json.schema.checkPropertyChange(_f8,_f9.schema.properties[_f7]));}if(_f7==_f9.idAttribute){throw new Error("Can not change the identity attribute for an item");}_f9.changing(_f6);_f6[_f7]=_f8;if(_f8&&!_f8.__parent){_f8.__parent=_f6;}_f9.onSet(_f6,_f7,old,_f8);},setValues:function(_fa,_fb,_fc){if(!dojo.isArray(_fc)){throw new Error("setValues expects to be passed an Array object as its value");}this.setValue(_fa,_fb,_fc);},unsetAttribute:function(_fd,_fe){this.changing(_fd);var old=_fd[_fe];delete _fd[_fe];this.onSet(_fd,_fe,old,undefined);},save:function(_ff){if(!(_ff&&_ff.global)){(_ff=_ff||{}).service=this.service;}if("syncMode" in _ff?_ff.syncMode:this.syncMode){dojox.rpc._sync=true;}var _100=dojox.rpc.JsonRest.commit(_ff);this.serverVersion=this._updates&&this._updates.length;return _100;},revert:function(_101){dojox.rpc.JsonRest.revert(_101&&_101.global&&this.service);},isDirty:function(item){return dojox.rpc.JsonRest.isDirty(item);},isItem:function(item,_102){return item&&item.__id&&(_102||this.service==dojox.rpc.JsonRest.getServiceAndId(item.__id).service);},_doQuery:function(args){var _103=typeof args.queryStr=="string"?args.queryStr:args.query;var _104=dojox.rpc.JsonRest.query(this.service,_103,args);var self=this;if(this.loadReferencedSchema){_104.addCallback(function(_105){var _106=_104.ioArgs&&_104.ioArgs.xhr&&_104.ioArgs.xhr.getResponseHeader("Content-Type");var _107=_106&&_106.match(/definedby\s*=\s*([^;]*)/);if(_106&&!_107){_107=_104.ioArgs.xhr.getResponseHeader("Link");_107=_107&&_107.match(/<([^>]*)>;\s*rel="?definedby"?/);}_107=_107&&_107[1];if(_107){var _108=dojox.rpc.JsonRest.getServiceAndId((self.target+_107).replace(/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/,"$2$3"));var _109=dojox.rpc.JsonRest.byId(_108.service,_108.id);_109.addCallbacks(function(_10a){dojo.mixin(self.schema,_10a);return _105;},function(_10b){console.error(_10b);return _105;});return _109;}return undefined;});}return _104;},_processResults:function(_10c,_10d){var _10e=_10c.length;return {totalCount:_10d.fullLength||(_10d.request.count==_10e?(_10d.request.start||0)+_10e*2:_10e),items:_10c};},getConstructor:function(){return this._constructor;},getIdentity:function(item){var id=item.__clientId||item.__id;if(!id){return id;}var _10f=this.service.servicePath.replace(/[^\/]*$/,"");return id.substring(0,_10f.length)!=_10f?id:id.substring(_10f.length);},fetchItemByIdentity:function(args){var id=args.identity;var _110=this;if(id.toString().match(/^(\w*:)?\//)){var _111=dojox.rpc.JsonRest.getServiceAndId(id);_110=_111.service._store;args.identity=_111.id;}args._prefix=_110.service.servicePath.replace(/[^\/]*$/,"");return _110.inherited(arguments);},onSet:function(){},onNew:function(){},onDelete:function(){},getFeatures:function(){var _112=this.inherited(arguments);_112["dojo.data.api.Write"]=true;_112["dojo.data.api.Notification"]=true;return _112;},getParent:function(item){return item&&item.__parent;}});dojox.data.JsonRestStore.getStore=function(_113,_114){if(typeof _113.target=="string"){_113.target=_113.target.match(/\/$/)||_113.allowNoTrailingSlash?_113.target:(_113.target+"/");var _115=(dojox.rpc.JsonRest.services[_113.target]||{})._store;if(_115){return _115;}}return new (_114||dojox.data.JsonRestStore)(_113);};dojox.data._getStoreForItem=function(item){if(item.__id){var _116=dojox.rpc.JsonRest.getServiceAndId(item.__id);if(_116&&_116.service._store){return _116.service._store;}else{var _117=item.__id.toString().match(/.*\//)[0];return new dojox.data.JsonRestStore({target:_117});}}return null;};dojox.json.ref._useRefs=true;}if(!dojo._hasResource["dojox.data.util.JsonQuery"]){dojo._hasResource["dojox.data.util.JsonQuery"]=true;dojo.provide("dojox.data.util.JsonQuery");dojo.declare("dojox.data.util.JsonQuery",null,{useFullIdInQueries:false,_toJsonQuery:function(args,_118){var _119=true;var self=this;function _11a(path,_11b){var _11c=_11b.__id;if(_11c){var _11d={};_11d[self.idAttribute]=self.useFullIdInQueries?_11b.__id:_11b[self.idAttribute];_11b=_11d;}for(var i in _11b){var _11e=_11b[i];var _11f=path+(/^[a-zA-Z_][\w_]*$/.test(i)?"."+i:"["+dojo._escapeString(i)+"]");if(_11e&&typeof _11e=="object"){_11a(_11f,_11e);}else{if(_11e!="*"){_120+=(_119?"":"&")+_11f+((!_11c&&typeof _11e=="string"&&args.queryOptions&&args.queryOptions.ignoreCase)?"~":"=")+(self.simplifiedQuery?encodeURIComponent(_11e):dojo.toJson(_11e));_119=false;}}}};if(args.query&&typeof args.query=="object"){var _120="[?(";_11a("@",args.query);if(!_119){_120+=")]";}else{_120="";}args.queryStr=_120.replace(/\\"|"/g,function(t){return t=="\""?"'":t;});}else{if(!args.query||args.query=="*"){args.query="";}}var sort=args.sort;if(sort){args.queryStr=args.queryStr||(typeof args.query=="string"?args.query:"");_119=true;for(i=0;i<sort.length;i++){args.queryStr+=(_119?"[":",")+(sort[i].descending?"\\":"/")+"@["+dojo._escapeString(sort[i].attribute)+"]";_119=false;}if(!_119){args.queryStr+="]";}}if(_118&&(args.start||args.count)){args.queryStr=(args.queryStr||(typeof args.query=="string"?args.query:""))+"["+(args.start||"")+":"+(args.count?(args.start||0)+args.count:"")+"]";}if(typeof args.queryStr=="string"){args.queryStr=args.queryStr.replace(/\\"|"/g,function(t){return t=="\""?"'":t;});return args.queryStr;}return args.query;},jsonQueryPagination:true,fetch:function(args){this._toJsonQuery(args,this.jsonQueryPagination);return this.inherited(arguments);},isUpdateable:function(){return true;},matchesQuery:function(item,_121){_121._jsonQuery=_121._jsonQuery||dojox.json.query(this._toJsonQuery(_121));return _121._jsonQuery([item]).length;},clientSideFetch:function(_122,_123){_122._jsonQuery=_122._jsonQuery||dojox.json.query(this._toJsonQuery(_122));return this.clientSidePaging(_122,_122._jsonQuery(_123));},querySuperSet:function(_124,_125){if(!_124.query){return _125.query;}return this.inherited(arguments);}});}if(!dojo._hasResource["dojox.data.JsonQueryRestStore"]){dojo._hasResource["dojox.data.JsonQueryRestStore"]=true;dojo.provide("dojox.data.JsonQueryRestStore");dojo.requireIf(!!dojox.data.ClientFilter,"dojox.json.query");dojo.declare("dojox.data.JsonQueryRestStore",[dojox.data.JsonRestStore,dojox.data.util.JsonQuery],{matchesQuery:function(item,_126){return item.__id&&(item.__id.indexOf("#")==-1)&&this.inherited(arguments);}});}if(!dojo._hasResource["dojox.rpc.Client"]){dojo._hasResource["dojox.rpc.Client"]=true;dojo.provide("dojox.rpc.Client");(function(){dojo._defaultXhr=dojo.xhr;dojo.xhr=function(_127,args){var _128=args.headers=args.headers||{};_128["Client-Id"]=dojox.rpc.Client.clientId;_128["Seq-Id"]=dojox._reqSeqId=(dojox._reqSeqId||0)+1;return dojo._defaultXhr.apply(dojo,arguments);};})();dojox.rpc.Client.clientId=(Math.random()+"").substring(2,14)+(new Date().getTime()+"").substring(8,13);}if(!dojo._hasResource["dojo.AdapterRegistry"]){dojo._hasResource["dojo.AdapterRegistry"]=true;dojo.provide("dojo.AdapterRegistry");dojo.AdapterRegistry=function(_129){this.pairs=[];this.returnWrappers=_129||false;};dojo.extend(dojo.AdapterRegistry,{register:function(name,_12a,wrap,_12b,_12c){this.pairs[((_12c)?"unshift":"push")]([name,_12a,wrap,_12b]);},match:function(){for(var i=0;i<this.pairs.length;i++){var pair=this.pairs[i];if(pair[1].apply(this,arguments)){if((pair[3])||(this.returnWrappers)){return pair[2];}else{return pair[2].apply(this,arguments);}}}throw new Error("No match found");},unregister:function(name){for(var i=0;i<this.pairs.length;i++){var pair=this.pairs[i];if(pair[0]==name){this.pairs.splice(i,1);return true;}}return false;}});}if(!dojo._hasResource["dojox.io.xhrPlugins"]){dojo._hasResource["dojox.io.xhrPlugins"]=true;dojo.provide("dojox.io.xhrPlugins");(function(){var _12d;var _12e;function _12f(){return _12e=dojox.io.xhrPlugins.plainXhr=_12e||dojo._defaultXhr||dojo.xhr;};dojox.io.xhrPlugins.register=function(){var _130=_12f();if(!_12d){_12d=new dojo.AdapterRegistry();dojo[dojo._defaultXhr?"_defaultXhr":"xhr"]=function(_131,args,_132){return _12d.match.apply(_12d,arguments);};_12d.register("xhr",function(_133,args){if(!args.url.match(/^\w*:\/\//)){return true;}var root=window.location.href.match(/^.*?\/\/.*?\//)[0];return args.url.substring(0,root.length)==root;},_130);}return _12d.register.apply(_12d,arguments);};dojox.io.xhrPlugins.addProxy=function(_134){var _135=_12f();dojox.io.xhrPlugins.register("proxy",function(_136,args){return true;},function(_137,args,_138){args.url=_134+encodeURIComponent(args.url);return _135.call(dojo,_137,args,_138);});};var _139;dojox.io.xhrPlugins.addCrossSiteXhr=function(url,_13a){var _13b=_12f();if(_139===undefined&&window.XMLHttpRequest){try{var xhr=new XMLHttpRequest();xhr.open("GET","http://testing-cross-domain-capability.com",true);_139=true;dojo.config.noRequestedWithHeaders=true;}catch(e){_139=false;}}dojox.io.xhrPlugins.register("cs-xhr",function(_13c,args){return (_139||(window.XDomainRequest&&args.sync!==true&&(_13c=="GET"||_13c=="POST"||_13a)))&&(args.url.substring(0,url.length)==url);},_139?_13b:function(){var _13d=dojo._xhrObj;dojo._xhrObj=function(){var xdr=new XDomainRequest();xdr.readyState=1;xdr.setRequestHeader=function(){};xdr.getResponseHeader=function(_13e){return _13e=="Content-Type"?xdr.contentType:null;};function _13f(_140,_141){return function(){xdr.readyState=_141;xdr.status=_140;};};xdr.onload=_13f(200,4);xdr.onprogress=_13f(200,3);xdr.onerror=_13f(404,4);return xdr;};var dfd=(_13a?_13a(_12f()):_12f()).apply(dojo,arguments);dojo._xhrObj=_13d;return dfd;});};dojox.io.xhrPlugins.fullHttpAdapter=function(_142,_143){return function(_144,args,_145){var _146={};var _147={};if(_144!="GET"){_147["http-method"]=_144;if(args.putData&&_143){_146["http-content"]=args.putData;delete args.putData;_145=false;}if(args.postData&&_143){_146["http-content"]=args.postData;delete args.postData;_145=false;}_144="POST";}for(var i in args.headers){var _148=i.match(/^X-/)?i.substring(2).replace(/-/g,"_").toLowerCase():("http-"+i);_147[_148]=args.headers[i];}args.query=dojo.objectToQuery(_147);dojo._ioAddQueryToUrl(args);args.content=dojo.mixin(args.content||{},_146);return _142.call(dojo,_144,args,_145);};};})();}if(!dojo._hasResource["dojo.io.script"]){dojo._hasResource["dojo.io.script"]=true;dojo.provide("dojo.io.script");(function(){var _149=dojo.isIE?"onreadystatechange":"load",_14a=/complete|loaded/;dojo.io.script={get:function(args){var dfd=this._makeScriptDeferred(args);var _14b=dfd.ioArgs;dojo._ioAddQueryToUrl(_14b);dojo._ioNotifyStart(dfd);if(this._canAttach(_14b)){var node=this.attach(_14b.id,_14b.url,args.frameDoc);if(!_14b.jsonp&&!_14b.args.checkString){var _14c=dojo.connect(node,_149,function(evt){if(evt.type=="load"||_14a.test(node.readyState)){dojo.disconnect(_14c);_14b.scriptLoaded=evt;}});}}dojo._ioWatch(dfd,this._validCheck,this._ioCheck,this._resHandle);return dfd;},attach:function(id,url,_14d){var doc=(_14d||dojo.doc);var _14e=doc.createElement("script");_14e.type="text/javascript";_14e.src=url;_14e.id=id;_14e.charset="utf-8";return doc.getElementsByTagName("head")[0].appendChild(_14e);},remove:function(id,_14f){dojo.destroy(dojo.byId(id,_14f));if(this["jsonp_"+id]){delete this["jsonp_"+id];}},_makeScriptDeferred:function(args){var dfd=dojo._ioSetArgs(args,this._deferredCancel,this._deferredOk,this._deferredError);var _150=dfd.ioArgs;_150.id=dojo._scopeName+"IoScript"+(this._counter++);_150.canDelete=false;_150.jsonp=args.callbackParamName||args.jsonp;if(_150.jsonp){_150.query=_150.query||"";if(_150.query.length>0){_150.query+="&";}_150.query+=_150.jsonp+"="+(args.frameDoc?"parent.":"")+dojo._scopeName+".io.script.jsonp_"+_150.id+"._jsonpCallback";_150.frameDoc=args.frameDoc;_150.canDelete=true;dfd._jsonpCallback=this._jsonpCallback;this["jsonp_"+_150.id]=dfd;}return dfd;},_deferredCancel:function(dfd){dfd.canceled=true;if(dfd.ioArgs.canDelete){dojo.io.script._addDeadScript(dfd.ioArgs);}},_deferredOk:function(dfd){var _151=dfd.ioArgs;if(_151.canDelete){dojo.io.script._addDeadScript(_151);}return _151.json||_151.scriptLoaded||_151;},_deferredError:function(_152,dfd){if(dfd.ioArgs.canDelete){if(_152.dojoType=="timeout"){dojo.io.script.remove(dfd.ioArgs.id,dfd.ioArgs.frameDoc);}else{dojo.io.script._addDeadScript(dfd.ioArgs);}}console.log("dojo.io.script error",_152);return _152;},_deadScripts:[],_counter:1,_addDeadScript:function(_153){dojo.io.script._deadScripts.push({id:_153.id,frameDoc:_153.frameDoc});_153.frameDoc=null;},_validCheck:function(dfd){var _154=dojo.io.script;var _155=_154._deadScripts;if(_155&&_155.length>0){for(var i=0;i<_155.length;i++){_154.remove(_155[i].id,_155[i].frameDoc);_155[i].frameDoc=null;}dojo.io.script._deadScripts=[];}return true;},_ioCheck:function(dfd){var _156=dfd.ioArgs;if(_156.json||(_156.scriptLoaded&&!_156.args.checkString)){return true;}var _157=_156.args.checkString;if(_157&&eval("typeof("+_157+") != 'undefined'")){return true;}return false;},_resHandle:function(dfd){if(dojo.io.script._ioCheck(dfd)){dfd.callback(dfd);}else{dfd.errback(new Error("inconceivable dojo.io.script._resHandle error"));}},_canAttach:function(_158){return true;},_jsonpCallback:function(json){this.ioArgs.json=json;}};})();}if(!dojo._hasResource["dojo.io.iframe"]){dojo._hasResource["dojo.io.iframe"]=true;dojo.provide("dojo.io.iframe");dojo.io.iframe={create:function(_159,_15a,uri){if(window[_159]){return window[_159];}if(window.frames[_159]){return window.frames[_159];}var _15b=null;var turi=uri;if(!turi){if(dojo.config["useXDomain"]&&!dojo.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}turi=(dojo.config["dojoBlankHtmlUrl"]||dojo.moduleUrl("dojo","resources/blank.html"));}var _15c=dojo.isIE?"<iframe name=\""+_159+"\" src=\""+turi+"\" onload=\""+_15a+"\">":"iframe";_15b=dojo.doc.createElement(_15c);with(_15b){name=_159;setAttribute("name",_159);id=_159;}dojo.body().appendChild(_15b);window[_159]=_15b;with(_15b.style){if(!(dojo.isSafari<3)){position="absolute";}left=top="1px";height=width="1px";visibility="hidden";}if(!dojo.isIE){this.setSrc(_15b,turi,true);_15b.onload=new Function(_15a);}return _15b;},setSrc:function(_15d,src,_15e){try{if(!_15e){if(dojo.isWebKit){_15d.location=src;}else{frames[_15d.name].location=src;}}else{var idoc;if(dojo.isIE||dojo.isWebKit>521){idoc=_15d.contentWindow.document;}else{if(dojo.isSafari){idoc=_15d.document;}else{idoc=_15d.contentWindow;}}if(!idoc){_15d.location=src;return;}else{idoc.location.replace(src);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_15f){var doc=_15f.contentDocument||(((_15f.name)&&(_15f.document)&&(dojo.doc.getElementsByTagName("iframe")[_15f.name].contentWindow)&&(dojo.doc.getElementsByTagName("iframe")[_15f.name].contentWindow.document)))||((_15f.name)&&(dojo.doc.frames[_15f.name])&&(dojo.doc.frames[_15f.name].document))||null;return doc;},send:function(args){if(!this["_frame"]){this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");}var dfd=dojo._ioSetArgs(args,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _160=null;try{var _161=dfd.ioArgs;var dii=dojo.io.iframe;var ifd=dii.doc(dii._frame);var _162=_161.handleAs;_160=ifd;if(_162!="html"){if(_162=="xml"){if(dojo.isIE){dojo.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _163=(dii._frame.contentWindow.document).documentElement.innerText;_163=_163.replace(/>\s+</g,"><");_163=dojo.trim(_163);var _164={responseText:_163};_160=dojo._contentHandlers["xml"](_164);}}else{_160=ifd.getElementsByTagName("textarea")[0].value;if(_162=="json"){_160=dojo.fromJson(_160);}else{if(_162=="javascript"){_160=dojo.eval(_160);}}}}}catch(e){_160=e;}finally{_161._callNext();}return _160;},function(_165,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _165;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;dojo.io.iframe._currentDfd=null;dojo.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();dojo._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}do{var dfd=this._currentDfd=this._dfdQueue.shift();}while(dfd&&dfd.canceled&&this._dfdQueue.length);if(!dfd||dfd.canceled){this._currentDfd=null;return;}var _166=dfd.ioArgs;var args=_166.args;_166._contentToClean=[];var fn=dojo.byId(args["form"]);var _167=args["content"]||{};if(fn){if(_167){var _168=function(name,_169){var tn;if(dojo.isIE){tn=dojo.doc.createElement("<input type='hidden' name='"+name+"'>");}else{tn=dojo.doc.createElement("input");tn.type="hidden";tn.name=name;}tn.value=_169;fn.appendChild(tn);_166._contentToClean.push(name);};for(var x in _167){var val=_167[x];if(dojo.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_168(x,val[i]);}}else{if(!fn[x]){_168(x,val);}else{fn[x].value=val;}}}}var _16a=fn.getAttributeNode("action");var _16b=fn.getAttributeNode("method");var _16c=fn.getAttributeNode("target");if(args["url"]){_166._originalAction=_16a?_16a.value:null;if(_16a){_16a.value=args.url;}else{fn.setAttribute("action",args.url);}}if(!_16b||!_16b.value){if(_16b){_16b.value=(args["method"])?args["method"]:"post";}else{fn.setAttribute("method",(args["method"])?args["method"]:"post");}}_166._originalTarget=_16c?_16c.value:null;if(_16c){_16c.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;dojo._ioNotifyStart(dfd);fn.submit();}else{var _16d=args.url+(args.url.indexOf("?")>-1?"&":"?")+_166.query;dojo._ioNotifyStart(dfd);this.setSrc(this._frame,_16d,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _16e=dfd.ioArgs;var args=_16e.args;var _16f=dojo.byId(args.form);if(_16f){var _170=_16e._contentToClean;for(var i=0;i<_170.length;i++){var key=_170[i];for(var j=0;j<_16f.childNodes.length;j++){var _171=_16f.childNodes[j];if(_171.name==key){dojo.destroy(_171);break;}}}if(_16e["_originalAction"]){_16f.setAttribute("action",_16e._originalAction);}if(_16e["_originalTarget"]){_16f.setAttribute("target",_16e._originalTarget);_16f.target=_16e._originalTarget;}}_16e._finished=true;}};}if(!dojo._hasResource["dojox.io.scriptFrame"]){dojo._hasResource["dojox.io.scriptFrame"]=true;dojo.provide("dojox.io.scriptFrame");(function(){var _172=dojo.io.script;dojox.io.scriptFrame={_waiters:{},_loadedIds:{},_getWaiters:function(_173){return this._waiters[_173]||(this._waiters[_173]=[]);},_fixAttachUrl:function(url){},_loaded:function(_174){var _175=this._getWaiters(_174);this._loadedIds[_174]=true;this._waiters[_174]=null;for(var i=0;i<_175.length;i++){var _176=_175[i];_176.frameDoc=dojo.io.iframe.doc(dojo.byId(_174));_172.attach(_176.id,_176.url,_176.frameDoc);}}};var _177=_172._canAttach;var _178=dojox.io.scriptFrame;_172._canAttach=function(_179){var fId=_179.args.frameDoc;if(fId&&dojo.isString(fId)){var _17a=dojo.byId(fId);var _17b=_178._getWaiters(fId);if(!_17a){_17b.push(_179);dojo.io.iframe.create(fId,dojox._scopeName+".io.scriptFrame._loaded('"+fId+"');");}else{if(_178._loadedIds[fId]){_179.frameDoc=dojo.io.iframe.doc(_17a);this.attach(_179.id,_179.url,_179.frameDoc);}else{_17b.push(_179);}}return false;}else{return _177.apply(this,arguments);}};})();}if(!dojo._hasResource["dojox.io.xhrScriptPlugin"]){dojo._hasResource["dojox.io.xhrScriptPlugin"]=true;dojo.provide("dojox.io.xhrScriptPlugin");dojox.io.xhrScriptPlugin=function(url,_17c,_17d){dojox.io.xhrPlugins.register("script",function(_17e,args){return args.sync!==true&&(_17e=="GET"||_17d)&&(args.url.substring(0,url.length)==url);},function(_17f,args,_180){var send=function(){args.callbackParamName=_17c;if(dojo.body()){args.frameDoc="frame"+Math.random();}return dojo.io.script.get(args);};return (_17d?_17d(send,true):send)(_17f,args,_180);});};}if(!dojo._hasResource["dojox.data.PersevereStore"]){dojo._hasResource["dojox.data.PersevereStore"]=true;dojo.provide("dojox.data.PersevereStore");dojox.json.ref.serializeFunctions=true;dojo.declare("dojox.data.PersevereStore",dojox.data.JsonQueryRestStore,{useFullIdInQueries:true,jsonQueryPagination:false});dojox.data.PersevereStore.getStores=function(path,sync){path=(path&&(path.match(/\/$/)?path:(path+"/")))||"/";if(path.match(/^\w*:\/\//)){dojox.io.xhrScriptPlugin(path,"callback",dojox.io.xhrPlugins.fullHttpAdapter);}var _181=dojo.xhr;dojo.xhr=function(_182,args){(args.headers=args.headers||{})["Server-Methods"]=false;return _181.apply(dojo,arguments);};var _183=dojox.rpc.Rest(path,true);dojox.rpc._sync=sync;var dfd=_183("Class/");var _184;var _185={};var _186=0;dfd.addCallback(function(_187){dojox.json.ref.resolveJson(_187,{index:dojox.rpc.Rest._index,idPrefix:"/Class/",assignAbsoluteIds:true});function _188(_189){if(_189["extends"]&&_189["extends"].prototype){if(!_189.prototype||!_189.prototype.isPrototypeOf(_189["extends"].prototype)){_188(_189["extends"]);dojox.rpc.Rest._index[_189.prototype.__id]=_189.prototype=dojo.mixin(dojo.delegate(_189["extends"].prototype),_189.prototype);}}};function _18a(_18b,_18c){if(_18b&&_18c){for(var j in _18b){var _18d=_18b[j];if(_18d.runAt!="client"&&!_18c[j]){_18c[j]=(function(_18e){return function(){var _18f=dojo.rawXhrPost({url:this.__id,postData:dojo.toJson({method:_18e,id:_186++,params:dojo._toArray(arguments)}),handleAs:"json"});_18f.addCallback(function(_190){return _190.error?new Error(_190.error):_190.result;});return _18f;};})(j);}}}};for(var i in _187){if(typeof _187[i]=="object"){var _191=_187[i];_188(_191);_18a(_191.methods,_191.prototype=_191.prototype||{});_18a(_191.staticMethods,_191);_185[_187[i].id]=new dojox.data.PersevereStore({target:new dojo._Url(path,_187[i].id)+"/",schema:_191});}}return (_184=_185);});dojo.xhr=_181;return sync?_184:dfd;};dojox.data.PersevereStore.addProxy=function(){dojox.io.xhrPlugins.addProxy("/proxy/");};}
